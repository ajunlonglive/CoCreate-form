/* CoCreateJS */
var CoCreateForm={data:{},init:function(t){const e=t||document;if(!e.querySelectorAll)return;let i=e.querySelectorAll("form"),r=this;0===i.length&&e!=document&&"FORM"===e.tagName&&(i=[e]),i.forEach(t=>{r.initForm(t)})},initForm:function(t){const e=t.querySelector(".submitBtn, .registerBtn");this.initAttribute(t),this.setFormData(t),CoCreateUtils.disableAutoFill(t),e&&this.setSubmitEvent(t,e)},initFormsByLoad:function(){let t=this;document.querySelectorAll("form").forEach(e=>{t.initAttribute(e)})},initAttribute:function(t){if(!t.getAttribute("data-collection"))return;const e=t.getAttribute("data-collection")||"",i=t.getAttribute("data-realtime");t.querySelectorAll("[name], [data-pass_to]").forEach(function(t){t.parentNode.classList.contains("template")||(null==t.getAttribute("data-realtime")&&i&&t.setAttribute("data-realtime",i),t.getAttribute("name")&&!CoCreateUtils.existAttribute(t,"data-collection")&&t.setAttribute("data-collection",e),t.getAttribute("data-pass_to")&&!CoCreateUtils.existAttribute(t,"data-pass_collection")&&t.setAttribute("data-pass_collection",e))})},setFormData:function(t){var e=t.getAttribute("data-form_id");e&&(this.data[e]={validates:[]})},setSubmitEvent:function(t,e){let i=this;var r=t.getAttribute("data-realtime")||"true";e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();const a=t.querySelectorAll(g_moduleSelectors.join(","));if(!i.checkFormValidate(t))return void alert("Values are not unique");let o=!1;for(var n=0;n<a.length;n++){let t=a[n];const e=t.getAttribute("data-document_id");if("false"!=t.getAttribute("data-save_value"))if(e){if(!CoCreateUtils.isRealTime(t,r)){if(i.isTemplateInput(t))return;var l=new CustomEvent("clicked-submitBtn",{detail:{type:"submitBtn"}});t.dispatchEvent(l)}}else t.getAttribute("name")&&(o=!0)}o&&CoCreateDocument.requestDocumentIdOfForm(t)})},checkFormValidate:function(t){const e=t.getAttribute("data-form_id");if(!e)return!0;const i=this.data[e].validates;for(var r=0;r<i.length;r++)if(!i[r].unique)return!1;return!0},isTemplateInput:function(t){if(t.classList.contains("template"))return!0;let e=t.parentNode;for(;e;){if(e.classList&&e.classList.contains("template"))return!0;e=e.parentNode}return!1}};CoCreateForm.initFormsByLoad(),CoCreate.registerSocketInit(CoCreateForm.init,CoCreateForm),CoCreateInit.register("CoCreateForm",CoCreateForm,CoCreateForm.init);